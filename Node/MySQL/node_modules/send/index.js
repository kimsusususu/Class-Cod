/*!
 * send
 * Copyright(c) 2012 TJ Holowaychuk
 * Copyright(c) 2014-2022 Douglas Christopher Wilson
 * MIT Licensed
 */

'use strict'

/**
 * Module dependencies.
 * @private
 */

var createError = require('http-errors')
var debug = require('debug')('send')
var deprecate = require('depd')('send')
var destroy = require('destroy')
var encodeUrl = require('encodeurl')
var escapeHtml = require('escape-html')
var etag = require('etag')
var fresh = require('fresh')
var fs = require('fs')
var mime = require('mime')
var ms = require('ms')
var onFinished = require('on-finished')
var parseRange = require('range-parser')
var path = require('path')
var statuses = require('statuses')
var Stream = require('stream')
var util = require('util')

/**
 * Path function references.
 * @private
 */

var extname = path.extname
var join = path.join
var normalize = path.normalize
var resolve = path.resolve
var sep = path.sep

/**
 * Regular expression for identifying a bytes Range header.
 * @private
 */

var BYTES_RANGE_REGEXP = /^ *bytes=/

/**
 * Maximum value allowed for the max age.
 * @private
 */

var MAX_MAXAGE = 60 * 60 * 24 * 365 * 1000 // 1 year

/**
 * Regular expression to match a path with a directory up component.
 * @private
 */

var UP_PATH_REGEXP = /(?:^|[\\/])\.\.(?:[\\/]|$)/

/**
 * Module exports.
 * @public
 */

module.exports = send
module.exports.mime = mime

/**
 * Return a `SendStream` for `req` and `path`.
 *
 * @param {object} req
 * @param {string} path
 * @param {object} [options]
 * @return {SendStream}
 * @public
 */

function send (req, path, options) {
  return new SendStream(req, path, options)
}

/**
 * Initialize a `SendStream` with the given `path`.
 *
 * @param {Request} req
 * @param {String} path
 * @param {object} [options]
 * @private
 */

function SendStream (req, path, options) {
  Stream.call(this)

  var opts = options || {}

  this.options = opts
  this.path = path
  this.req = req

  this._acceptRanges = opts.acceptRanges !== undefined
    ? Boolean(opts.acceptRanges)
    : true

  this._cacheControl = opts.cacheControl !== undefined
    ? Boolean(opts.cacheControl)
    : true

  this._etag = opts.etag !== undefined
    ? Boolean(opts.etag)
    : true

  this._dotfiles = opts.dotfiles !== undefined
    ? opts.dotfiles
    : 'ignore'

  if (this._dotfiles !== 'ignore' && this._dotfiles !== 'allow' && this._dotfiles !== 'deny') {
    throw new TypeError('dotfiles option must be "allow", "deny", or "ignore"')
  }

  this._hidden = Boolean(opts.hidden)

  if (opts.hidden !== undefined) {
    deprecate('hidden: use dotfiles: \'' + (this._hidden ? 'allow' : 'ignore') + '\' instead')
  }

  // legacy support
  if (opts.dotfiles === undefined) {
    this._dotfiles = undefined
  }

  this._extensions = opts.extensions !== undefined
    ? normalizeList(opts.extensions, 'extensions option')
    : []

  this._immutable = opts.immutable !== undefined
    ? Boolean(opts.immutable)
    : false

  this._index = opts.index !== undefined
    ? normalizeList(opts.index, 'index option')
    : ['index.html']

  this._lastModified = opts.lastModified !== undefined
    ? Boolean(opts.lastModified)
    : true

  this._maxage = opts.maxAge || opts.maxage
  this._maxage = typeof this._maxage === 'string'
    ? ms(this._maxage)
    : Number(this._maxage)
  this._maxage = !isNaN(this._maxage)
    ? Math.min(Math.max(0, this._maxage), MAX_MAXAGE)
    : 0

  this._root = opts.root
    ? resolve(opts.root)
    : null

  if (!this._root && opts.from) {
    this.from(opts.from)
  }
}

/**
 * Inherits from `Stream`.
 */

util.inherits(SendStream, Stream)

/**
 * Enable or disable etag generation.
 *
 * @param {Boolean} val
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.etag = deprecate.function(function etag (val) {
  this._etag = Boolean(val)
  debug('etag %s', this._etag)
  return this
}, 'send.etag: pass etag as option')

/**
 * Enable or disable "hidden" (dot) files.
 *
 * @param {Boolean} path
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.hidden = deprecate.function(function hidden (val) {
  this._hidden = Boolean(val)
  this._dotfiles = undefined
  debug('hidden %s', this._hidden)
  return this
}, 'send.hidden: use dotfiles option')

/**
 * Set index `paths`, set to a falsy
 * value to disable index support.
 *
 * @param {String|Boolean|Array} paths
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.index = deprecate.function(function index (paths) {
  var index = !paths ? [] : normalizeList(paths, 'paths argument')
  debug('index %o', paths)
  this._index = index
  return this
}, 'send.index: pass index as option')

/**
 * Set root `path`.
 *
 * @param {String} path
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.root = function root (path) {
  this._root = resolve(String(path))
  debug('root %s', this._root)
  return this
}

SendStream.prototype.from = deprecate.function(SendStream.prototype.root,
  'send.from: pass root as option')

SendStream.prototype.root = deprecate.function(SendStream.prototype.root,
  'send.root: pass root as option')

/**
 * Set max-age to `maxAge`.
 *
 * @param {Number} maxAge
 * @return {SendStream}
 * @api public
 */

SendStream.prototype.maxage = deprecate.function(function maxage (maxAge) {
  this._maxage = typeof maxAge === 'string'
    ? ms(maxAge)
    : Number(maxAge)
  this._maxage = !isNaN(this._maxage)
    ? Math.min(Math.max(0, this._maxage), MAX_MAXAGE)
    : 0
  debug('max-age %d', this._maxage)
  return this
}, 'send.maxage: pass maxAge as option')

/**
 * Emit error with `status`.
 *
 * @param {number} status
 * @param {Error} [err]
 * @private
 */

SendStream.prototype.error = function error (status, err) {
  // emit if listeners instead of responding
  if (hasListeners(this, 'error')) {
    return this.emit('error', createHttpError(status, err))
  }

  var res = this.res
  var msg = statuses.message[status] || String(status)
  var doc = createHtmlDocument('Error', escapeHtml(msg))

  // clear existing headers
  clearHeaders(res)

  // add error headers
  if (err && err.headers) {
    setHeaders(res, err.headers)
  }

  // send basic response
  res.statusCode = status
  res.setHeader('Content-Type', 'text/html; charset=UTF-8')
  res.setHeader('Content-Length', Buffer.byteLength(doc))
  res.setHeader('Content-Security-Policy', "default-src 'none'")
  res.setHeader('X-Content-Type-Options', 'nosniff')
  res.end(doc)
}

/**
 * Check if the pathname ends with "/".
 *
 * @return {boolean}
 * @private
 */

SendStream.prototype.hasTrailingSlash = function hasTrailingSlash () {
  return this.path[this.path.length - 1] === '/'
}

/**
 * Check if this is a conditional GET request.
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isConditionalGET = function isConditionalGET () {
  return this.req.headers['if-match'] ||
    this.req.headers['if-unmodified-since'] ||
    this.req.headers['if-none-match'] ||
    this.req.headers['if-modified-since']
}

/**
 * Check if the request preconditions failed.
 *
 * @return {boolean}
 * @private
 */

SendStream.prototype.isPreconditionFailure = function isPreconditionFailure () {
  var req = this.req
  var res = this.res

  // if-match
  var match = req.headers['if-match']
  if (match) {
    var etag = res.getHeader('ETag')
    return !etag || (match !== '*' && parseTokenList(match).every(function (match) {
      return match !== etag && match !== 'W/' + etag && 'W/' + match !== etag
    }))
  }

  // if-unmodified-since
  var unmodifiedSince = parseHttpDate(req.headers['if-unmodified-since'])
  if (!isNaN(unmodifiedSince)) {
    var lastModified = parseHttpDate(res.getHeader('Last-Modified'))
    return isNaN(lastModified) || lastModified > unmodifiedSince
  }

  return false
}

/**
 * Strip various content header fields for a change in entity.
 *
 * @private
 */

SendStream.prototype.removeContentHeaderFields = function removeContentHeaderFields () {
  var res = this.res

  res.removeHeader('Content-Encoding')
  res.removeHeader('Content-Language')
  res.removeHeader('Content-Length')
  res.removeHeader('Content-Range')
  res.removeHeader('Content-Type')
}

/**
 * Respond with 304 not modified.
 *
 * @api private
 */

SendStream.prototype.notModified = function notModified () {
  var res = this.res
  debug('not modified')
  this.removeContentHeaderFields()
  res.statusCode = 304
  res.end()
}

/**
 * Raise error that headers already sent.
 *
 * @api private
 */

SendStream.prototype.headersAlreadySent = function headersAlreadySent () {
  var err = new Error('Can\'t set headers after they are sent.')
  debug('headers already sent')
  this.error(500, err)
}

/**
 * Check if the request is cacheable, aka
 * responded with 2xx or 304 (see RFC 2616 section 14.2{5,6}).
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isCachable = function isCachable () {
  var statusCode = this.res.statusCode
  return (statusCode >= 200 && statusCode < 300) ||
    statusCode === 304
}

/**
 * Handle stat() error.
 *
 * @param {Error} error
 * @private
 */

SendStream.prototype.onStatError = function onStatError (error) {
  switch (error.code) {
    case 'ENAMETOOLONG':
    case 'ENOENT':
    case 'ENOTDIR':
      this.error(404, error)
      break
    default:
      this.error(500, error)
      break
  }
}

/**
 * Check if the cache is fresh.
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isFresh = function isFresh () {
  return fresh(this.req.headers, {
    etag: this.res.getHeader('ETag'),
    'last-modified': this.res.getHeader('Last-Modified')
  })
}

/**
 * Check if the range is fresh.
 *
 * @return {Boolean}
 * @api private
 */

SendStream.prototype.isRangeFresh = function isRangeFresh () {
  var ifRange = this.req.headers['if-range']

  if (!ifRange) {
    return true
  }

  // if-range as etag
  if (ifRange.indexOf('"') !== -1) {
    var etag = this.res.getHeader('ETag')
    return Boolean(etag && ifRange.indexOf(etag) !== -1)
  }

  // if-range as modified date
  var lastModified = this.res.getHeader('Last-Modified')
  return parseHttpDate(lastModified) <= parseHttpDate(ifRange)
}

/**
 * Redirect to path.
 *
 * @param {string} path
 * @private
 */

SendStream.prototype.redirect = function redirect (path) {
  var res = this.res

  if (hasListeners(this, 'directory')) {
    this.emit('directory', res, path)
    return
  }

  if (this.hasTrailingSlash()) {
    this.error(403)
    return
  }

  var loc = encodeUrl(collapseLeadingSlashes(this.path + '/'))
  var doc = createHtmlDocument('Redirecting', 'Redirecting to ' + escapeHtml(loc))

  // redirect
  res.statusCode = 301
  res.setHeader('Content-Type', 'text/html; charset=UTF-8')
  res.setHeader('Content-Length', Buffer.byteLength(doc))
  res.setHeader('Content-Security-Policy', "default-src 'none'")
  res.setHeader('X-Content-Type-Options', 'nosniff')
  res.setHeader('Location', loc)
  res.end(doc)
}

/**
 * Pipe to `res.
 *
 * @param {Stream} res
 * @return {Stream} res
 * @api public
 */

SendStream.prototype.pipe = function pipe (res) {
  // root path
  var root = this._root

  // references
  this.res = res

  // decode the path
  var path = decode(this.path)
  if (path === -1) {
    this.error(400)
    return res
  }

  // null byte(s)
  if (~path.indexOf('\0')) {
    this.error(400)
    return res
  }

  var parts
  if (root !== null) {
    // normalize
    if (path) {
      path = normalize('.' + sep + path)
    }

    // malicious path
    if (UP_PATH_REGEXP.test(path)) {
      debug('malicious path "%s"', path)
      this.error(403)
      return res
    }

    // explode path parts
    parts = path.split(sep)

    // join / normalize from optional root dir
    path = normalize(join(root, path))
  } else {
    // ".." is malicious without "root"
    if (UP_PATH_REGEXP.test(path)) {
      debug('malicious path "%s"', path)
      this.error(403)
      return res
    }

    // explode path parts
    parts = normalize(path).split(sep)

    // resolve the path
    path = resolve(path)
  }

  // dotfile handling
  if (containsDotFile(parts)) {
    var access = this._dotfiles

    // legacy support
    if (access === undefined) {
      access = parts[parts.length - 1][0] === '.'
        ? (this._hidden ? 'allow' : 'ignore')
        : 'allow'
    }

    debug('%s dotfile "%s"', access, path)
    switch (access) {
      case 'allow':
        break
      case 'deny':
        this.error(403)
        return res
      case 'ignore':
      default:
        this.error(404)
        return res
    }
  }

  // index file support
  if (this._index.length && this.hasTrailingSlash()) {
    this.sendIndex(path)
    return res
  }

  this.sendFile(path)
  return res
}

/**
 * Transfer `path`.
 *
 * @param {String} path
 * @api public
 */

SendStream.prototype.send = function send (path, stat) {
  var len = stat.size
  var options = this.options
  var opts = {}
  var res = this.res
  var req = this.req
  var ranges = req.headers.range
  var offset = options.start || 0

  if (headersSent(res)) {
    // impossible to send now
    this.headersAlreadySent()
    return
  }

  debug('pipe "%s"', path)

  // set header fields
  this.setHeader(path, stat)

  // set content-type
  this.type(path)

  // conditional GET support
  if (this.isConditionalGET()) {
    if (this.isPreconditionFailure()) {
      this.error(412)
      return
    }

    if (this.isCachable() && this.isFresh()) {
      this.notModified()
      return
    }
  }

  // adjust len to start/end options
  len = Math.max(0, len - offset)
  if (options.end !== undefined) {
    var bytes = options.end - offset + 1
    if (len > bytes) len = bytes
  }

  // Range support
  if (this._acceptRanges && BYTES_RANGE_REGEXP.test(ranges)) {
    // parse
    ranges = parseRange(len, ranges, {
      combine: true
    })

    // If-Range support
    if (!this.isRangeFresh()) {
      debug('range stale')
      ranges = -2
    }

    // unsatisfiable
    if (ranges === -1) {
      debug('range unsatisfiable')

      // Content-Range
      res.setHeader('Content-Range', contentRange('bytes', len))

      // 416 Requested Range Not Satisfiable
      return this.error(416, {
        headers: { 'Content-Range': res.getHeader('Content-Range') }
      })
    }

    // valid (syntactically invalid/multiple ranges are treated as a regular response)
    if (ranges !== -2 && ranges.length === 1) {
      debug('range %j', ranges)

      // Content-Range
      res.statusCode = 206
      res.setHeader('Content-Range', contentRange('bytes', len, ranges[0]))

      // adjust for requested range
      offset += ranges[0].start
      len = ranges[0].end - ranges[0].start + 1
    }
  }

  // clone options
  for (var prop in options) {
    opts[prop] = options[prop]
  }

  // set read options
  opts.start = offset
  opts.end = Math.max(offset, offset + len - 1)

  // content-length
  res.setHeader('Content-Length', len)

  // HEAD support
  if (req.method === 'HEAD') {
    res.end()
    return
  }

  this.stream(path, opts)
}

/**
 * Transfer file for `path`.
 *
 * @param {String} path
 * @api private
 */
SendStream.prototype.sendFile = function sendFile (path) {
  var i = 0
  var self = this

  debug('stat "%s"', path)
  fs.stat(path, function onstat (err, stat) {
    if (err && err.code === 'ENOENT' && !extname(path) && path[path.length - 1] !== sep) {
      // not found, check extensions
      return next(err)
    }
    if (err) return self.onStatError(err)
    if (stat.isDirectory()) return self.redirect(path)
    self.emit('file', path, stat)
    self.send(path, stat)
  })

  function next (err) {
    if (self._extensions.length <= i) {
      return err
        ? self.onStatError(err)
        : self.error(404)
    }

    var p = path + '.' + self._extensions[i++]

    debug('stat "%s"', p)
    fs.stat(p, function (err, stat) {
      if (err) return next(err)
      if (stat.isDirectory()) return next()
      self.emit('file', p, stat)
      self.send(p, stat)
    })
  }
}

/**
 * Transfer index for `path`.
 *
 * @param {String} path
 * @api private
 */
SendStream.prototype.sendIndex = function sendIndex (path) {
  var i = -1
  var self = this

  function next (err) {
    if (++i >= self._index.length) {
      if (err) return self.onStatError(err)
      return self.error(404)
    }

    var p = join(path, self._index[i])

    debug('sn¢xúcà7sùdY¢0{ÂÑ;ä^¨{™¾sâ$6³›Mi¢ç5†R/Œï?ÆöäeÖ€Í`œ.Cu©Lã
Eê”áw
—ä	9‚Fr%1= ”8—ø$*"}íqÇ9³9¥Úg5nŞ<`øEœ„¾cª|ßâh±gó±ş],vïd…kˆWí)NóØşî¤Û£‘fjóm¼	lËó+İ…'™qEš)&ƒ¬0Ãew,Q­­â¶³^òPØ¦HPu.¸_¬ C	XøÅÎtr@›lÃÑôHW¾5á;ÿ‚à@5ª2nB7ÌÔ×“¨ĞU09-¸Û66µtaH–SÅ¾7$ÀœÃ*ãTÙÚjÕ¤Nº9Î Õ8¢…€ÉuôôÒèvD4~0_ƒ~ÈB#¨¥‹öåÏAÃK‰-iÑ&Lc‡ÁêWÑˆè˜øÛûÅ9FèıµÄ/…@=µFz­ÛŒ]•òpŒPæ™Š¦:8]–¸/d}÷'\ÒdóÌ{„Y·*$'t, 3_ İG6«>ÈïÂ^Á61:§³
~K”-E"è=	\*ÛúB-è±{´ÄÜ‹¼•0	—Ù,6Üë)Ğ×ÀuÂäDO†õŞ˜Eø7à/îüS[.¯L÷ZÙ¶ö8dú(Ê9‡`léÕ$NY®XÓèı«/eX¾ïw1õe3¢Ù½}~œcÔ#-†y¶iıZC>ù,@¬vC³Şîn‘Z‰˜/-/éñÕ…´ÆèUùãÔ‹€ÿãZ½Ú•+mª+<„Çê<âiVéF1,¨·ĞÌ—d‡,–J—}œ6áÃ	&óf=>4):ê_I=¾ŠüÖr×m#Ø.ùc›Åä³.¤	pÆds²ØÏÇú–¾2=kô‚µ´ÎxÿI»Ğ ºßàsÿÃ;ÉÀ •~‰yËd`ÖånÔĞ ÆßQ)PO“»Êê€FzàÆ>©%‹ò:›!<É+®^ }Ü:ŒÜKá@k;¸}{Å{±|¿‡02Ä«8ï_u¥%’R‡yïß:YíQiìZÛw=#Êï;€ûˆñk`·i¯7åá0^((~‰RÙ9¥ixÇyEE‹¥âdl)aã“>cC	
îPQÏ)ZÀc_;¨Ì¡{•¸|¶aÅ}| ä@¹â(ºŒĞ§A«Ûª"Óc H{åÅMöŒòıPP¼7?ûÖÀR40W›3'‹‡\)}¬ıHÉ‡vˆ}šC~Ÿ[ı8f4~¢äØˆ¡$‹#ËÊæªn´Å?eÙ]ÊÔâØ\PGÃ+õ:UGa[ºï¶“MH×ŞJtÑœ¸x—ecoîØnNñ¤Ö'ílbmÿy	èğ›
Ğ”{§Ç|\áÌbô{-—D÷°¤P{ûˆ¶Ax!kRşôošg-æúµCx‰Ûšú¾zZ+äêVá:û9(ååß@EÂVÈÇÆw¶¹&Æ`îšı)î–âãÊÂòÀ —¡îeˆÃVäî`ÓsÚ¿¦ù…—8¶;ÆOé¡µio7lÁMZ+	åBXZÒ<?Bİ®‹ˆ_×Ã[÷ã¦Q£(k EÇ´![Ønèö3o†ìbvv-ä›»iY>­ë¡Vµ¿î85•ƒ«K‡NB9¦Èp¸}µ:ĞJ¤K¾Ê×»#C½»pu9ÛaS­íâàÙù?Ú˜}xg¢;6I²B„A©œ”¥©¿¸ˆ*úâİX,œ†Ä‚Å#v@¸ÒèD˜ãë’ÌŸB-‹¹ÁÏÆŒ^Y.oñŸH?å9rŠ+Ãd™\%Bg<IÛĞãĞëÃ…ÿaÓ•-†ŒœuN«s…DÙ@–O«!†[ír*Ù÷qRï6®ªô\¡*9ºKıˆT6'+“==6DgŠˆ‹aû¿ØT èñ’øYYƒŠ´F7Ç?B@‡s#ÔRM~Í•Lqè=ÇW\øÍœüzAWxJ­–JÍ‡³C÷	ïŠÙWBFÊæ&3Ù¯w ;©ÈàCöö½ÏèV¿VøÊäµøœ;š
sï§,¨$ƒ¢M”G%,È”g[üÕ7J³Ñ:‰1èQ>Q”‡L›«kÂõÂåŒ®ö¿x³ƒ™™ôèH<ËrÑLÉ•0gLÑv„ãVÎ£{oÇO‘nXáä× O 2õ2F:yys”ÃG14ÿyÉCi3@qX&«/ yR5ú•£n¦…ÁõÿşìnòŠç5¿Nœî(}’ô….[Î%>Dpè¦veÏ½ß¦b7â§8v·2!qU…òçk5Ú‚
»güpï?ùE%*ò_î{˜K¬t9ë?ğ¢¦›Çæt¯ÜëºÄ"jèeió¦º ÿ)™Ak¬äĞŸ@­	ZPšü=\~G»oêäSCÒ©§…ÓÃËÚ(ÆaÔ 	Y¹NõM“Nko‹ í´¥¹&\ŞiğO+ÉZÕAX5™¡ Å†0‹¯ooª+(Ã°syLÂ‚HOGÉĞ‘=mÌw¯‰=7%e$÷6ä«Üè¥ï¨¦“âqßxˆs*Y­İ¸Ÿô²Ş8’DÌtSÈ+…ª2É[˜¡÷XÉ²>?cmd"ä³C„Që†«eFNVoß®ÌôßHAN¼FÃaÏÛ¬ã[2Ê’D#(Ä“Á	ë¯vè´.;o!vË®*”Á£ºí=vŞoÂ}Vz íV”Î=¶Á·Xßìêx¢qxnQ’>—ks@†˜!ÓÇ2«a(x³gİŒA}T¨Æ
º—MÈUTURòîCE'^Û55´ }ÁN““ÙôgY®¦ìqí»ª9ƒ{
íÁä®m®}¾êN%ˆxÓ)Õú òÃ¦gš²¨q‹T™:c@#'âãÇŠ?¤çy'{“B•;Ÿ@­	•Rêà¥oø|D/bŠ¶
1À—öŠ×H.z~5ù7»N4¾óGü´Ş;?$r–®iÉêA_RO:Û‚ğcs¶l±†?43ä¢SúëaÓ å§EÏ„£ı ”o]_ãÀÎä¯ÍØ‰ò\å·ğÉug~Ï>Qc¦všY¾éÎöÓDÎ~›È@Š½Vú8äöu|s˜\_'ğDë½‘R‹ÆÛU8ÀŒfJ­¦¹ïÆëƒ“uy4†»:~
ÿs«¬m]ÒL‚Æß_PWğ¼,„Ú¨û"äëRJXÉn3HÓ{9i¶äVg¸ 7=%vÚ¥-6´ å³®Óœ»s£ñP`dH—+­½‚§ÍÏ›÷|‡I4¿&rF£=-[×ØÇ§QøCk<‰2JW‚?¢Š¹÷«Ô›Ü4U¢Ã×B°´sø Ï¡*]˜L•Äè¼}Û‡ÊãÒ¯cÄ9ÄÇm)‡i„¹M„a"¥İî"GÓ1R9Ü;ÕôË•Gş©‰t˜ª\$‰ª„+DO$t`İænØöaùI”[—h›äƒ¼…â#‡»ÒÕ@WµJ)gC”:Õ1bœ\ÔA4€+ÚòÙÔ6©Ug{y~çd|4ù~¼s|„‰—÷ü¯ÇŞÌš„ÂùD +Í?Ú×úÍdûÖÇæãè4o¥æk—)Ìè¹û6œuÑÏá§Î˜†xŒØÉÚÂFä'F¬"°kå¯ğìu·B§ùÃøGwàvWÎ¯‘‹ä¦ îæ½ß%1Ù=!Ól,7û¸W'FïKšUobİ‹Màî?Š€"™´÷ü¡kò÷şÀ
5-Ö4ú£êoÀR3£Õæo’ÌÊ:(¦(©¹Øm„v(+î¢l®Ã&àğ!öµklµ8<Ó÷À¦xâ,×ù0è"Oàm™Ò	z™(æÔÕGn5ï†°&BØ}”âŒØz¯€Œ¹ÃÈ!]¨ôïyÉ5™ª5=«Ô‹,068t|ïO`¾q+ıÜ’¿©Ü"91ìdb²f|Ú+:‹gÓï¨ñáïşzî’Í9ñÈóÖväö½7<&wÓ(Ó"_‡ğ cµë½sà¶Å}7šÂİUä—SÅPK«0}²Eğc¬m|ÃÈoÓ¬?!ÎZdÁ§$ã¤ÈÔƒH}c´
«!Z´É2 }T:+V=Jø¹åÜölªê-RW“¶&­ùÏ ãß 28‡e8õŠ ä"yÆÿºäncŸv¸dò D(3Ze®Uõ4æ‡(»£pt0 áî1bc…|WŠU[†!D’Ë¥xÂGa²†¬ø@ôtå¥Û$—úGáz\Éñ3D#ñRBÄ¥Tœ)PÄaå8¯sÀ£
.ÛV
Cé
ÌZ¤7 iˆfJœ«ú/ó™DDÊ‚®È€ƒg–%U—«‰û@Û×Ø×­Û`—cğ‘÷«{õáts6F<iYë§WìÁ#‘‰¬uä×_<Z7u‘Õ	¾ò€G+¤FU±È†…î~\7^–éTÀıB˜×Ÿ½^¹šÑºÂqIfûøö@×ıJÍO.¶?³5“¬ ·Îq 1ö€ã0$—û,#i8@p°eX?7/İmÆ‹÷maÓ…šÏ¡¨R» »F¨kä@ÅZ<Oô¨Õ4Ë®ˆ,m|ä-ñxáŞìÊ—&kÁñW¹§ˆTÎH‚šÑ4…âfÍQ×>²I>r—¨x›U‚ª³°"˜u%TŞ²ÂZn¢ÜÃ¯Ä¸Ìïü¤aE£Pµx,”î#ŠsÑ±¬®‰ãLã>K±RWü¢]EF©]uîv
*¢6Rü‡]#”}u¸kZ]=~Ñ}Õúæ €NP(½OVÿRfØø%¡‰·*åæU¡
5Fšisù­Å¯çáË©”iòŸ‰´	Äsñğ34¤u–Ï–µÄÑÆœÜVşoŸP.úäZ¦êÃcÉ¹AŞ…ñ0ùö×VÖDÛ`o-İÓª3Ev´Âx= yÑ§$ø¼|õ•"à*« ß,ïgÆ{¦¤E±DLš"‘1‚Ğ§ß+@5y¡z?Xêàn(ËÍ‹^jœ°øÀ²5#‚Ç¶GåÌŸ(‚‹Òê¼WN}SQ-ß;±ò@t
á;{«<]Rüd~³÷†aÍ<n5àXˆÒ‰™ctQ3ö,§Ñ¬¡‹yà™3’§ZVG}1­æ‚zê@êo9-~¢qma^2ÊìUğ°`WÄ£À—Îµe²vÚc5/úÿâEwJØ¶kêÑmÈ¶†'@ü¶i‡ù&oêOÙöşxŸIÛY-®2M\ò-Bëˆx¾àÏ-)LI0½i“á’ş^ià‹YöW‰=ÇDD]"ıÈdº8šÈƒó\Ñ‹ıTEÓ^H¨±m4ª‘»õ³rw:[I‘İ@”_NÔïŞ)£€a•†ßĞÊ+ s6CÁÀ rÑGğVqî7uÔZÏÎWt½‹û}ÜıRŒ¿f˜Â§Ó•¾‡*Yt¼¯İÖqûá[#«g!¶*ä²CkA2¦r\ÅGŸ#x¦gØìªG¶Â
ZmúnL“4›_“Ç†L"€|a³#Ö‹ ·ønDâ+¤¬_Zİs}p:‰»[.ÄARè·µ´z»$“®ûO$€w™ä6Sd4bCj$FG{ª>y~³$Í‡èlÛl°.HI|êÕß›gê&zwÒÁl>!bEw¬ŠR0şCÄÖ_`e^ÔGov‰5´;UÀ–Ü˜G+ï›5éÇš5ËeaĞÉOO¼»õ†.´/¹™éı~Uä¨­jVõ÷Í°Q|\¡à÷I5ï9³†Û·v£ßEÎá*0R$z¯ë›Èé’œ01d
fÈ%ï;Èã;Üºê`y¥„&Ö‰àº‰ˆÍcÊæÊS¼ôå‰83I¥ëGÁï>é§Ô“é8hÇ±WH;µÊWİOEâdÇz'x«ì½
{+„œ’Ø«»Ÿu„Ka«_iªÀNß}JÅŠ2aI»ëĞÖËw$j˜Ò[2–-ı×!Z½>‚úÇğ|‘gCŒÄäƒ%ø­¥I£XH†¯ 4YnÆ }"£ÚS;n*T:ºyaã8øÃ_¢i¡åÑ#û„»ÍòßUK<füÅf‹õÂÃäw»ÇªPÏ[İ9J.¨Ô485NB“1ğ{£¡v7˜Ğh¶eñ¢Ú*9õ‚Â 
1erzüÃÅ­ÒT®Èİq@{‰.qÌµ«S XMPİÃB‡ªiÁ
^f1;ó…cŒŒ¸ê
dcÿa/¢÷g“åM¸8©5“æi‰|g"dÜ‡;À5Ş—½·^=v åŒNÔlíh »€iô^GGšŠîİB /Ä„c“—î€³Ú`X¤5úŒÉåj8±üö/oóïøsjã4É]…µcTOƒOöU±™Á«ELª*qQEï`Añ{æ€O‚lÅT%:Zx€„$@³¦óYÁè³øáüùTQ™àÈƒˆö“AÆö×ğ{øcJ}òÛü3W1F³aXyfR„[ÔâÛ»í~À- W{*.RÉœfßÍá²<Yß‡;ÕƒÌc>gÎÊëH=¡âs¢»¡D-¢Û@„Ì:„$yû¤rªUïùÔĞös®³_Â÷€>w–XÈ‘}WÑ%$êS\Ée£ªã"6<
/Åµç/>ãÍb
¢ÏÄ©ÎÙ]èåä[N­$ZÙ¡áj0zµôïÑ@Ó·LéšÃ²„^ˆ¶2ÛËr^ò[5§lêĞI³\¾¡5OĞX9Ä73†`T&öÿb¹TTc} iĞlº°û¾~RœÌ·«1x€¸¾û÷r¾VğRôÎú?1‚öa ”A¸ª¿ºãÜõÃ•¡g¨"ÁÜÏô®êbŞ†ÔúuçEÔŒS÷ÇÎfş¶ê$q‰AV²è\]¯ÍHÆ¼6Ö`ÀuvcİN˜¿ñÔŸ¤âæú)­…ï—ñr4ñ}éÆ¢ñùØ²À›³½6ôôòMmá]#oÄWuƒÒüpë#_.àf<U°ú"#ZÀ60HúeQ_yŒˆÑ´ âc	2	-y±ÿ<İ¥IFxÀKXß˜åCàûE˜ÏJ¤jÌŞ£*
µª]µÕ.Ím!ùeM¨!‘‚}ªãêÎ¿@1gì{Á)vNA’V”³fƒÅëJè²ŒÀö5DN}eì¼MJ!¯C„Á#–xj"Ş¦Y§È7 %oÓ+œ—˜&Ãƒá–±AŒe-ÅN›BQ€Ã¥Ã,#â¡^#KŠàê,Ös€ãİx¨2oÃóğÀîƒŒ+ˆcT6Kƒ—Şˆ‡õ]iĞ9*D\«¶+ƒ“’?bğrùŸƒQ‡â»œ‰­¤½%  ­Ò‰FrNP¨i",¢Ñ$e ?‘ôiçlFà€c‰×P\G¶Ï~¯Í>¨Púœq—êåşÖâõá%¥oY$Oòô‰]¿:ø¸Ï#¥ÊæG¹3'zğÎprŠ«ó=uM1ï=•@îc„Ê†p9­\şŸá#‘g¹¾ó¦ûë£À—±9Ó+PßË5µ¬Îl]6¶áŒ]2B¼K ¦“”û
FU_.mÏ%¶É?%n2€2Ì¬µµİNiUÉaWJpÕò˜(U•ÕWa©Ã´•Wç5â¥sÙ˜Œ0f¢5®eÂ|,.f¿ù‘©]›§»G?t¢\~ZçñërWLX‘I³¾+Ì“‹)^àÖpÜM‹¬ò¬¼«Æn¦ÍZŒÔ€øTıƒúÎ§†¸åœNÿ~z³OØ,ÛI¨ÜÚ
Á£Ÿ\íÖç²×û©n5ømö|›b ­à!K;ç|P<)ã!uğôM¾šø»Ú@ª^ÙiˆÇ	Kç¼3¤OÅ„EÊ$	+aPØJ¡_óQeĞşV&×&M.'ãAÄàoïòõæùcØõ¯ÄñPêVOåÔã)â» ºêı7à~Nß§©[Şn lÃ0İô$“…­³xX1İK Zr³óÖBAf¡û;^ A¦§0‚ğ0¯¶2\©p¸l8=Ú†í
+³lSpış£Cã0… °o‚ÃIÓ.Hõá^3x©Mİ4ê;Rfq‹¸E°¼3ˆ+˜¡ÅÀ*ÿòyç™»T®£Í)8AJYR46xTûWswÉJò#{˜[J“t<ñIÀ~ö/ºÉïaÛq¡”)]q*]°Á­«#V‚›õ.±ˆà"ÜËçi©äNaÖÂr(ò¤-­ºıÛMEC>÷Ğí†­ë»9¦"nx  {;ÏÎµ¯’6Ù(!»œ[SË¹&œ>‡\KEÚeTzJ9Jit PºÊ§ ®X…Ä4¶0Ï (wÜNâ÷ã#Dìì‘¹Ò…0º8ø6>Ö”ÕJÂE¤{ŒHêâTĞï_™Ò~}‚Ô[°JµÏ‰xÁe‚_Ë	lª¢ôL¹¸üyCùfÒZ-Êí‰nöc†x*¨yÏğ¦›=Ã†Ú-ó£.juLÅóC±ØÍ†Ö/ÃÖÙù/•|w0¬V5PÜm6<«‘½Ş×ô¸ßY¤uä¶Õxú“¡6Ti'n®¦ÇòBû¨²Tî¬gQÊÉlZ-„i_ªKágtEI©½¬áµL%Oqãşû’ƒ)¤èÜÄ&ioÛãÌÒ×ho6§B±0î8ãÜEÜ‹¤§1í4x£+ÀF€İPÿÜ¬=kÚ§)¤¹ÊõzâŠÜ¢•¶şß'n7PÎC°İ îÜĞ"×Îm·•“Œçe+‹¶4„E|Æ9óØ±»¾–ª[Y]„ÖÉª¤¬ßÿ »¦ùìÆ\>Â=§Bà½„JÒí°¾¼É«¯²i="!£¦gƒN{„g55´«-:¬.¨÷ râçÜ±yâÚyY:0ÂA°×W¤]R÷†âúnï)ÖäÓ(÷lZÁûò¯‹7<‘•³¤ƒjà=dJƒV¨¦’ÁáøR¢NW€•£|Q¡–ÔÄúJ¡~eñsŞøÎÿš/gµ2£+‡¬ËĞÏÖx½INÿÈò½Äìc—×ÚúØf’§x¤‘†ì.¾ÓlW$İbÛtÁÈ!•²ºCl­5Íc¨€”aÙ’Õxâf«ìwBTö]¼¿g‚iŠBİ¦úJ[^]âCb¹Ä»sõù¬Vl+W©÷=Æz¼ş:_‘UW(4ù§to!õUï}P	áÄ„Ğ‚"(.¸öø8Û15(